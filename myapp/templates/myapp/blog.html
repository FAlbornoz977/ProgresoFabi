<!DOCTYPE html>
<html data-bs-theme="light" lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
      <title>Metal Diseño</title>
      {% load static %}
      <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}">
      <link rel="stylesheet" href="{% static 'css/Hero-Clean-images.css' %}">
      <link rel="stylesheet" href="{% static 'css/Navbar-Centered-Links-icons.css' %}">
      <link rel="stylesheet" href="{% static 'css/style.css' %}">
   </head>
   <body>
      {% include 'includes/_navbar.html' %}
      <div class="container py-4 py-xl-5">
         <div class="row mb-5">
            <div class="col-md-8 col-xl-6 text-center mx-auto">
               <h2>Posts</h2>
               <p class="w-lg-50">Aquí podrás ver los trabajos más recientes</p>
            </div>
         </div>
         <div class="row gy-4 row-cols-1 row-cols-md-2">
            {% for post in posts %}
            <div class="col">
               <div class="d-flex flex-column flex-lg-row">
                  <div class="w-100">
                     {% if post.imagen %}
                     <img class="rounded img-fluid d-block w-100 fit-cover" style="height: 200px;" src="{{ post.imagen.url }}" alt="{{ post.titulo }}" data-bs-toggle="modal" data-bs-target="#imageModal{{ post.id }}">
                     {% else %}
                     <img class="rounded img-fluid d-block w-100 fit-cover" style="height: 200px;" src="https://cdn.bootstrapstudio.io/placeholders/1400x800.png" alt="{{ post.titulo }}" data-bs-toggle="modal" data-bs-target="#imageModal{{ post.id }}">
                     {% endif %}
                  </div>
                  <div class="py-4 py-lg-0 px-lg-4">
                     <h4>{{ post.titulo }}</h4>
                     <p>{{ post.contenido }}</p>
                     <p><strong>Lugar:</strong> {{ post.lugar }}</p>
                     <p><strong>Fecha:</strong> {{ post.fecha_posteado }}</p>
                     {% if user.is_authenticated %}
                     <a href="{% url 'edit_post' post.id %}" class="btn btn-sm btn-warning">Modificar</a>
                     <form action="{% url 'delete_post' post.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-sm btn-danger">Eliminar</button>
                     </form>
                     {% endif %}
                  </div>
               </div>
            </div>
            <!-- Modal para ver la imagen en grande -->
            <div class="modal fade" id="imageModal{{ post.id }}" tabindex="-1" aria-labelledby="imageModalLabel{{ post.id }}" aria-hidden="true">
               <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                     <div class="modal-header">
                        <h5 class="modal-title" id="imageModalLabel{{ post.id }}">{{ post.titulo }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                     </div>
                     <div class="modal-body">
                        {% if post.imagen %}
                        <img class="rounded img-fluid d-block w-100 fit-cover" style="height: 100%;" src="{{ post.imagen.url }}" alt="{{ post.titulo }}">
                        {% else %}
                        <img class="rounded img-fluid d-block w-100 fit-cover" style="height: 200px;" src="https://cdn.bootstrapstudio.io/placeholders/1400x800.png" alt="{{ post.titulo }}">
                        {% endif %}
                     </div>
                  </div>
               </div>
            </div>
            {% endfor %}
         </div>
      </div>
      {% include 'includes/_footer.html' %}
      <script src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
      <script src="{% static 'js/bs-init.js' %}"></script>
   </body>
</html>